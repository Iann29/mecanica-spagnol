# üõçÔ∏è FASE 5: SISTEMA DE PRODUTOS E CARRINHO

## üìã Vis√£o Geral

A Fase 5 implementa o sistema completo de produtos e carrinho de compras do e-commerce Mec√¢nica Spagnol, incluindo listagem, detalhes, carrinho e checkout.

**Dura√ß√£o estimada total**: 4-6 horas  
**Prioridade**: Alta  
**Depend√™ncias**: Fase 4 (Sistema de Autentica√ß√£o) conclu√≠da

---

## üéØ Objetivos da Fase 5

1. Sistema de listagem de produtos
2. P√°gina de detalhes do produto
3. Sistema de carrinho de compras
4. Checkout multi-etapa
5. Integra√ß√£o com Zustand (estado global)
6. Filtros e busca de produtos

---

## üìä Subfases Detalhadas

### üè™ Fase 5.1: Sistema de Produtos (2 horas)

#### Objetivos:
- Criar listagem de produtos
- Implementar p√°gina de detalhes
- Filtros e busca
- Integra√ß√£o com banco de dados

#### Arquivos a criar:

1. **`src/app/produtos/page.tsx`** - Listagem de produtos
```typescript
// Grid de produtos
// Filtros por categoria, pre√ßo, disponibilidade
// Pagina√ß√£o
// Busca por nome
```

2. **`src/app/produtos/[slug]/page.tsx`** - Detalhes do produto
```typescript
// Galeria de imagens
// Especifica√ß√µes t√©cnicas
// Bot√£o adicionar ao carrinho
// Quantidade selecion√°vel
```

3. **`src/components/shop/product-card.tsx`** - Card do produto
```typescript
// Imagem principal
// Nome, pre√ßo, desconto
// Bot√£o adicionar ao carrinho
// Badge de promo√ß√£o
```

4. **`src/components/shop/product-grid.tsx`** - Grid de produtos
```typescript
// Layout responsivo
// Estados de loading
// Produto n√£o encontrado
```

5. **`src/components/shop/product-filters.tsx`** - Filtros
```typescript
// Filtro por categoria
// Filtro por pre√ßo
// Filtro por disponibilidade
// Limpeza de filtros
```

6. **`src/lib/api/products.ts`** - API de produtos
```typescript
// getProducts() - com filtros
// getProductBySlug()
// getCategories()
// searchProducts()
```

#### Valida√ß√£o:
- [ ] Produtos carregam corretamente
- [ ] Filtros funcionam
- [ ] P√°gina de detalhes mostra informa√ß√µes
- [ ] Busca funciona
- [ ] Layout responsivo

---

### üõí Fase 5.2: Sistema de Carrinho (2 horas)

#### Objetivos:
- Implementar estado global com Zustand
- Criar p√°gina do carrinho
- Adicionar/remover produtos
- C√°lculos de pre√ßo e frete

#### Arquivos a criar:

1. **`src/store/cart.ts`** - Estado do carrinho (Zustand)
```typescript
// Estado: items[], total, itemCount
// A√ß√µes: addItem, removeItem, updateQuantity
// Persist√™ncia em localStorage
```

2. **`src/app/carrinho/page.tsx`** - P√°gina do carrinho
```typescript
// Lista de produtos no carrinho
// Atualiza√ß√£o de quantidade
// Remo√ß√£o de itens
// Resumo do pedido
```

3. **`src/components/cart/cart-item.tsx`** - Item do carrinho
```typescript
// Imagem do produto
// Nome, pre√ßo, quantidade
// Bot√µes +/- quantidade
// Bot√£o remover
```

4. **`src/components/cart/cart-summary.tsx`** - Resumo do carrinho
```typescript
// Subtotal
// Frete (calculado)
// Total
// Bot√£o finalizar compra
```

5. **`src/components/cart/cart-drawer.tsx`** - Carrinho lateral
```typescript
// Slide-out do carrinho
// Mini lista de produtos
// Bot√£o ir para carrinho
```

6. **`src/components/layout/cart-button.tsx`** - Bot√£o carrinho no header
```typescript
// √çcone com contador
// Abrir drawer
// Estado vazio/com items
```

#### Valida√ß√£o:
- [ ] Produtos adicionam ao carrinho
- [ ] Quantidade atualiza
- [ ] Remo√ß√£o funciona
- [ ] Totais calculam corretamente
- [ ] Persist√™ncia funciona

---

### üí≥ Fase 5.3: Checkout Multi-etapa (2 horas)

#### Objetivos:
- Implementar checkout em etapas
- Sele√ß√£o de endere√ßo
- M√©todo de pagamento
- Resumo do pedido

#### Arquivos a criar:

1. **`src/app/checkout/page.tsx`** - Checkout principal
```typescript
// Stepper de etapas
// Navega√ß√£o entre etapas
// Valida√ß√£o de cada etapa
```

2. **`src/components/checkout/address-step.tsx`** - Etapa endere√ßo
```typescript
// Sele√ß√£o de endere√ßo existente
// Formul√°rio novo endere√ßo
// Valida√ß√£o de endere√ßo
```

3. **`src/components/checkout/payment-step.tsx`** - Etapa pagamento
```typescript
// M√©todos de pagamento
// Formul√°rio de cart√£o (simulado)
// PIX (simulado)
```

4. **`src/components/checkout/summary-step.tsx`** - Etapa resumo
```typescript
// Resumo do pedido
// Endere√ßo selecionado
// M√©todo de pagamento
// Bot√£o finalizar
```

5. **`src/components/checkout/order-stepper.tsx`** - Stepper
```typescript
// Indicador de progresso
// Navega√ß√£o entre etapas
// Estados ativo/conclu√≠do
```

6. **`src/lib/api/orders.ts`** - API de pedidos
```typescript
// createOrder() - criar pedido
// getOrder() - buscar pedido
// updateOrderStatus()
```

#### Valida√ß√£o:
- [ ] Etapas navegam corretamente
- [ ] Endere√ßos carregam
- [ ] Valida√ß√£o funciona
- [ ] Pedido √© criado
- [ ] Redirect p√≥s-compra

---

## üóÑÔ∏è Estrutura de Dados

### Produtos
```typescript
interface Product {
  id: string;
  name: string;
  slug: string;
  price: number;
  sale_price?: number;
  stock_quantity: number;
  category: Category;
  images: string[];
  description: string;
  specifications: Record<string, unknown>;
  is_featured: boolean;
  is_active: boolean;
}
```

### Carrinho
```typescript
interface CartItem {
  product: Product;
  quantity: number;
  price: number; // pre√ßo no momento da adi√ß√£o
}

interface CartState {
  items: CartItem[];
  total: number;
  itemCount: number;
  shipping: number;
}
```

### Pedido
```typescript
interface Order {
  id: string;
  user_id: string;
  items: OrderItem[];
  address: Address;
  subtotal: number;
  shipping_cost: number;
  total: number;
  status: OrderStatus;
  payment_status: PaymentStatus;
}
```

---

## üöÄ Comandos √öteis

```bash
# Instalar Zustand
npm install zustand

# Instalar depend√™ncias de imagem
npm install next-cloudinary

# Testar localmente
npm run dev

# Build
npm run build
```

---

## üìù Notas de Implementa√ß√£o

### Zustand Store:
- Persist√™ncia com localStorage
- Middleware para sincroniza√ß√£o
- Tipagem TypeScript forte
- Otimiza√ß√µes de performance

### Imagens:
- Usar Next.js Image component
- Placeholder enquanto carrega
- Otimiza√ß√£o autom√°tica
- Lazy loading

### SEO:
- Metadata din√¢mica por produto
- Structured data (JSON-LD)
- URLs amig√°veis
- Sitemap din√¢mico

---

## ‚ú® Entreg√°veis da Fase 5

Ao final desta fase, teremos:

1. Sistema completo de produtos
2. Filtros e busca funcionais
3. Carrinho de compras persistente
4. Checkout multi-etapa
5. Integra√ß√£o com estado global
6. P√°gina de detalhes rica
7. Sistema de pedidos b√°sico
8. Layout responsivo

---

## üéØ Pr√≥ximos Passos (Fase 6)

Ap√≥s concluir a Fase 5, seguiremos para:
- Painel administrativo
- CRUD de produtos
- Upload de imagens
- Gest√£o de pedidos
- Relat√≥rios e m√©tricas

---

**√öltima atualiza√ß√£o**: 17/01/2025  
**Status**: Aguardando implementa√ß√£o

## üìã Arquivos a Implementar

### Fase 5.1 - Sistema de Produtos:
- [ ] `src/app/produtos/page.tsx`
- [ ] `src/app/produtos/[slug]/page.tsx`
- [ ] `src/components/shop/product-card.tsx`
- [ ] `src/components/shop/product-grid.tsx`
- [ ] `src/components/shop/product-filters.tsx`
- [ ] `src/lib/api/products.ts`

### Fase 5.2 - Sistema de Carrinho:
- [ ] `src/store/cart.ts`
- [ ] `src/app/carrinho/page.tsx`
- [ ] `src/components/cart/cart-item.tsx`
- [ ] `src/components/cart/cart-summary.tsx`
- [ ] `src/components/cart/cart-drawer.tsx`
- [ ] `src/components/layout/cart-button.tsx`

### Fase 5.3 - Checkout:
- [ ] `src/app/checkout/page.tsx`
- [ ] `src/components/checkout/address-step.tsx`
- [ ] `src/components/checkout/payment-step.tsx`
- [ ] `src/components/checkout/summary-step.tsx`
- [ ] `src/components/checkout/order-stepper.tsx`
- [ ] `src/lib/api/orders.ts`